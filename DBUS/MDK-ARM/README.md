# dbus协议与DT7,DR16的使用
## 一、代码逻辑
### 1、main.c中初始化DBUS串口（dbus_uart_init()），清除空闲标志位，使能空闲中断，接收数据
### 2、在函数USART3_IRQHandler()中调用uart_receive_handler(&huart3)，当数据接收完成且使能空闲中断时， 调用uart_rx_idle_callback(huart)处理接收到的数据（解包，归一化处理，判断拨码状态）
## 二、学习的知识
### 1、学习了DBUS协议，DMA的原理（帮助CPU搬运数据）
### 2、遇到的问题：
 (1)Cubemx上配置USART时的数据长度问题，DBUS通信的单元数据长度是8，奇偶校验位是偶校验。但Cubemx上配置的数据长度是8（including Parity）,所以为什么不配成9位
（2）数据类型的问题。在对摇杆值进行归一化处理时，我忽略了数据类型的问题，解包后的数据类型是int16_t,不是float，后参考校内赛蓝牙模块程序找到问题。
（3）sw状态的处理。依旧参考了校内赛蓝牙模块程序，但无法显示TRIG。后知道是状态停留时间太短，但还不知道如何解决。
 