# 一.代码组成
## 1.drv_can.c
### （1）发送函数（发送电流）CAN_cmd_single
### （2）can接收回调函数
### （3）接收数据解包函数get_motor_measure
## 2.motor.c
### （1）两个rpm与rad/s单位转化函数，电机初始化函数（用于设置两套pid参数，初始化用于存储电机各种数据的motor0）
### （2）motor_task(将实时数据传入pid,实现闭环控制)
## 3.pid.c
### （1）pid初始化函数
### （2）pid计算函数
# 二.代码逻辑
## 1.设定了一个motor0,用于存储电机各种数据。
## 2.use_direct_speed ，1时只跑速度环，2时跑串级
## 3.
### （1）速度环。main中给定一个set值，在定时器中调用motor_task，将更新的数据传入motor_measure_t *m ，再将值传入pid
### (2) 串级pid,在速度环之前加入角度环，更新目标速度
# 三.遇到的问题与解决方法
## 1.一开始没有实时更新电机的数据，导致电机疯转，后将数据更新到motor->chassis_motor_measure（通过motor_init）解决
## 2.不明白编码器的原理与位置环的程序编写，不知道该怎么用转子角度值，后去b站找视频，看代码学会
## 3.单位的转化问题，不理解设定的是速度（rpm），可发送的数据是电流值，不明白二者之间怎样建立联系，现在有点理解了。电调传回的是速度值，传进pid的也是速度值，跟电流没有固定的对应关系